<div class="alert-center" dir="rtl">
  <!-- Header -->
  <div class="header">
    <h1>ğŸš¨ ××¨×›×– ×”×ª×¨××•×ª</h1>
    <button class="btn-refresh" (click)="refresh()" [disabled]="loading">
      ğŸ”„ ×¨×¢× ×Ÿ
    </button>
  </div>

  <!-- Summary Cards -->
  <div *ngIf="summary" class="summary-cards">
    <div class="card">
      <div class="icon">ğŸ”´</div>
      <div class="content">
        <div class="label">×”×ª×¨××•×ª ×§×¨×™×˜×™×•×ª</div>
        <div class="value">{{ summary.active.critical }}</div>
      </div>
    </div>
    
    <div class="card">
      <div class="icon">âš ï¸</div>
      <div class="content">
        <div class="label">××–×”×¨×•×ª ×¤×¢×™×œ×•×ª</div>
        <div class="value">{{ summary.active.warning }}</div>
      </div>
    </div>
    
    <div class="card">
      <div class="icon">ğŸ“Š</div>
      <div class="content">
        <div class="label">×¡×”"×› ×¤×¢×™×œ×•×ª</div>
        <div class="value">{{ summary.active.total }}</div>
      </div>
    </div>
    
    <div class="card">
      <div class="icon">ğŸ“…</div>
      <div class="content">
        <div class="label">24 ×©×¢×•×ª ××—×¨×•× ×•×ª</div>
        <div class="value">{{ summary.last_24h.total }}</div>
      </div>
    </div>
  </div>

  <!-- Tabs -->
  <div class="tabs">
    <button 
      [class.active]="selectedTab === 'active'"
      (click)="changeTab('active')">
      ×”×ª×¨××•×ª ×¤×¢×™×œ×•×ª ({{ activeAlerts.length }})
    </button>
    <button 
      [class.active]="selectedTab === 'history'"
      (click)="changeTab('history')">
      ×”×™×¡×˜×•×¨×™×”
    </button>
    <button 
      [class.active]="selectedTab === 'statistics'"
      (click)="changeTab('statistics')">
      ×¡×˜×˜×™×¡×˜×™×§×•×ª
    </button>
    <button 
      [class.active]="selectedTab === 'config'"
      (click)="changeTab('config')">
      ×”×’×“×¨×•×ª
    </button>
  </div>

  <!-- Loading -->
  <div *ngIf="loading" class="loading">
    <div class="spinner"></div>
    <p>×˜×•×¢×Ÿ...</p>
  </div>

  <!-- Active Alerts Tab -->
  <div *ngIf="selectedTab === 'active' && !loading" class="tab-content">
    <div *ngIf="activeAlerts.length === 0" class="no-alerts">
      âœ… ××™×Ÿ ×”×ª×¨××•×ª ×¤×¢×™×œ×•×ª - ×”×›×œ ×ª×§×™×Ÿ!
    </div>

    <div class="alerts-list">
      <div 
        *ngFor="let alert of activeAlerts" 
        class="alert-item"
        [class.critical]="alert.severity === 'critical'"
        [class.warning]="alert.severity === 'warning'">
        
        <div class="alert-icon">{{ getSeverityIcon(alert.severity) }}</div>
        
        <div class="alert-content">
          <div class="alert-title">{{ alert.title }}</div>
          <div class="alert-message">{{ alert.message }}</div>
          <div class="alert-meta">
            <span>{{ getCategoryIcon(alert.category) }} {{ alert.category }}</span>
            <span>{{ timeAgo(alert.createdAt) }}</span>
            <span *ngIf="alert.count > 1">×—×–×¨ {{ alert.count }} ×¤×¢××™×</span>
          </div>
        </div>
        
        <div class="alert-actions">
          <button 
            *ngIf="!alert.acknowledged"
            class="btn-acknowledge"
            (click)="acknowledgeAlert(alert)">
            âœ“ ××™×©×•×¨
          </button>
          <button 
            class="btn-resolve"
            (click)="resolveAlert(alert)">
            âœ• ×¡×’×•×¨
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- History Tab -->
  <div *ngIf="selectedTab === 'history'" class="tab-content">
    <div class="alerts-list">
      <div 
        *ngFor="let alert of alertHistory" 
        class="alert-item history-item"
        [class.resolved]="alert.status === 'resolved'">
        
        <div class="alert-icon">{{ getSeverityIcon(alert.severity) }}</div>
        
        <div class="alert-content">
          <div class="alert-title">{{ alert.title }}</div>
          <div class="alert-message">{{ alert.message }}</div>
          <div class="alert-meta">
            <span>{{ timeAgo(alert.createdAt) }}</span>
            <span *ngIf="alert.status === 'resolved'">âœ“ × ×¤×ª×¨</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Statistics Tab -->
  <div *ngIf="selectedTab === 'statistics'" class="tab-content">
    <div class="stats-grid">
      <div class="stat-card">
        <h3>×”×ª×¨××•×ª ×œ×¤×™ ×§×˜×’×•×¨×™×”</h3>
        <div class="stat-list">
          <div *ngFor="let item of getCategoryEntries()" class="stat-row">
            <span class="label">{{ getCategoryIcon(item.category) }} {{ item.category }}</span>
            <span class="value">{{ item.count }}</span>
          </div>
        </div>
      </div>

      <div class="stat-card">
        <h3>×”×ª×¨××•×ª × ×¤×•×¦×•×ª</h3>
        <div class="stat-list">
          <div *ngFor="let item of statistics?.most_frequent" class="stat-row">
            <span class="label">{{ formatAlertType(item.type) }}</span>
            <span class="value">{{ item.count }}</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Config Tab -->
  <div *ngIf="selectedTab === 'config' && config" class="tab-content">
    <div class="config-form">
      <h3>×”×’×“×¨×•×ª ×¡×£ ×”×ª×¨××•×ª</h3>
      
      <div class="form-group">
        <label>×©×™×¢×•×¨ ×©×’×™××•×ª ××§×¡×™××œ×™ (%)</label>
        <input type="number" [(ngModel)]="config.error_rate_threshold">
      </div>

      <div class="form-group">
        <label>×–××Ÿ ×ª×’×•×‘×ª API ××™×˜×™ (ms)</label>
        <input type="number" [(ngModel)]="config.slow_api_threshold">
      </div>

      <div class="form-group">
        <label>×¡×£ ×›×©×œ×™ ×‘×™×˜×•×œ×™× (×œ×©×¢×”)</label>
        <input type="number" [(ngModel)]="config.cancellation_spike_threshold">
      </div>

      <div class="form-group">
        <label>×¡×£ ×™×¨×™×“×” ×‘×”×›× ×¡×•×ª (%)</label>
        <input type="number" [(ngModel)]="config.revenue_drop_threshold">
      </div>

      <div class="form-group">
        <label>×¡×£ ×©×™××•×© ××¢×‘×“ (%)</label>
        <input type="number" [(ngModel)]="config.cpu_threshold">
      </div>

      <div class="form-group">
        <label>×¡×£ ×©×™××•×© ×–×™×›×¨×•×Ÿ (%)</label>
        <input type="number" [(ngModel)]="config.memory_threshold">
      </div>

      <button class="btn-save" (click)="saveConfig()">
        ğŸ’¾ ×©××•×¨ ×”×’×“×¨×•×ª
      </button>
    </div>

    <div class="test-alerts">
      <h3>×”×ª×¨××•×ª ×‘×“×™×§×”</h3>
      <div class="test-buttons">
        <button class="btn-test" (click)="createTestAlert('error_rate')">
          ×‘×“×•×§ ×©×™×¢×•×¨ ×©×’×™××•×ª
        </button>
        <button class="btn-test" (click)="createTestAlert('slow_api')">
          ×‘×“×•×§ API ××™×˜×™
        </button>
        <button class="btn-test" (click)="createTestAlert('cancellation_spike')">
          ×‘×“×•×§ ×›×©×œ×™ ×‘×™×˜×•×œ×™×
        </button>
      </div>
    </div>
  </div>
</div>
